for (int i=0; i<I; ++i) {
  double T1[T], T2[T];
  for (int r=0; r<T; ++r) {
    T1[r] = ((a*A[i][r])+(b*B[i][r]));
    T2[r] = ((d*D[i][k])+(e*E[i][k]));
  }
  for (int j=0; j<T; ++j) {
    for (int k=0; k<T; ++k) {
      M[j][k] += ((T1[j]*A[i][k]*g)+
		  ((A[i][k]/c)+(T2[k]*f))*A[i][j])*det*W[i];
    }
  }
}
